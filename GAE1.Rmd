---
title: "GAE1"
subtitle: "Introduction to graded application exercises"
author: "T.H. Martin"
date: "Spring 2022"
output:
  bookdown::html_document2:
    number_sections: FALSE
    toc: TRUE
    code_download: true
    self_contained: true

toc-title: "Table of Contents"
bibliography:
- GAE1.bib
- R-GAE1.bib
csl: ecology.csl
---

# Scenario 1

## Setup code chunk:

```{r setup, message=FALSE}
# We can include comments inside code chunks by prefacing with "#"

# The opts_chunk$set() function sets the default behavior for all code
# chunks except the one it is in. Here I've told Rmarkdown to print out the 
# code chunk and to suppress information messages (but not warnings) in the
# code chunks that follow. We will usually set echo = FALSE to suppress
# printing the code in our output.

# You can change the behavior of individual code chunks by clicking on the 
# gear icon at the top right of the chunk and choosing your preferred options.

knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = TRUE
)

library(papaja)
library(tidyverse)
library(kableExtra)
library(latex2exp)   # Allows me to use LaTeX in ggplot2


# Use the papaja package to create a bibliography of package citations:
papaja::r_refs(file = "R-GAE1.bib")

```

Relatively early in your textbook [@QK], you'll be introduced to an example data set that was generated by @lovettetal2000. They studied the chemistry of forested watersheds in the Catskill Mountains in New York State. We'll use these data for an introduction to using ***LaTeX*** to write symbols and equations and to become more familiar with R, RStudio, and github.

@lovettetal2000 chose 39 sites (observations) on first and second order streams and measured the concentrations of ten chemical variables averaged over three years, and four watershed variables (maximum elevation (m), sample elevation (m), length of stream (m), watershed area (ha)).:

1.  $NO_3^-$ (`NO3`),
2.  Total Organic $N$ (`TON`),
3.  Total $N$ (`TN`),
4.  $NH_4^{2+}$ (`NH4`),
5.  Dissolved Organic $C$ (`DOC`),
6.  $SO_4^{2-}$ (`SO4`),
7.  $Cl^-$ (`CL`),
8.  $Ca^{2+}$ (`CA`),
9.  $Mg^{2+}$ (`MG`),
10. $H^+$ (`H`).

## Data import

The data are provided as a comma-separated-value (.csv) "[flat-file database](https://en.wikipedia.org/wiki/Flat-file_database)" by @QK,  "lovett.csv." I've imported this text file using the read_csv() function provided by the readr package [@R-readr] included in the tidyverse metapackage [@R-tidyverse]. This function will create a "tibble" which is a special case of ***data.frame***, the standard approach storing data in memory for most ***R*** operations.

```{r dataImport, message=FALSE}
df1 <- read_csv("lovett.csv", show_col_types = FALSE)
```

After importing the data, you may wish to check to make sure the command did what you wanted, or to have a look at the variables included in the data.frame. Like most operations in ***R***, there are a number of ways to do this, but my preferred approach is to take advantage of the RStudio IDE. If you click on the Environment tab in the upper right hand window of RStudio, you will get a list of all of the objects currently being stored in active memory for ***R***. If you click on the small arrow icon (expand) to the left of df1 (our data.frame) you will see the details of the list of vectors in the data.frame and their attributes. Note that STREAM is a vector of character data while all of the other vectors contain numeric data.

If you click on the spreadsheet icon to the far right of the data.frame name, RStudio will open a viewer that you can use to examine the data contained in the data.frame. This is purely a viewer and has no editing capabilities. 

In the expanded listing of the contents for df1, you may notice the dollar symbol, "$" -- this is actually an operator in ***R*** that allows you to address a specific part of an object. For example, in the code block below I ask ***R*** to print out the names of the streams:

```{r}
df1$STREAM
```

I could address an individual value by using numeric indices, e.g. if I wanted to just get length (row 4) of Santa Cruz (column 1), I could use:

```{r}
df1[1,4]
```

You may use this approach to list the contents of an entire column or row just by not including the number for the other value, e.g. if I wanted to list all of the measures for Santa Cruz (row 1): 

```{r}
df1[1,]
```
Or, if I wanted to just list the chemical parameters (rows 6 through 15) for Windham Ridge (row 5) while also including the stream name:

```{r}
# The "c" operator in R combines values.

df1[5,c(1,6:15)]
```
## Methods

You will have noticed that the format of the information we've produced up to this point isn't very attractive, readable, or easy to interpret. We need to produce publication-quality tables and figures to communicate with our readers. Typically we will summarize our data to condense it into a more easily understood form or display it in graphical form to help tell our story.

In the code-chunk below, I'm using the graphical abilities provided by the ggplot2 package [@R-ggplot2] provided by the tidyverse [@R-tidyverse] to produce a scatter plot of sulfate concentration (**SO4**) versus sample elevation (**SAMPELEV**).

```{r Fig1, fig.cap="Nitrate concentration versus elevation. Each observation was taken from a different stream."}

ggplot(data = df1, aes(x = SAMPELEV, y = NO3)) +
  geom_point(shape = 16, 
             size = 3,
             color = "darkorchid4", # pretty close to WCU purple with 
             alpha = 0.5) +         # alpha (transparency) set to 0.5
  geom_smooth(span = 2) +           # for span, smaller is wigglier
  labs(x = "Elevation where sample was taken (m)",
       y = TeX("$NO_3^- \\; (\\mu mol/L)$")) +
  theme_classic()                   # Produces and "old school" graph
```




# References:
